<!DOCTYPE html>
<html lang="ro">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Generator Utilizator - Varianta Tehnică</title>
    <style>
        body { font-family: sans-serif; display: flex; justify-content: center; padding-top: 50px; background: #eceff1; }
        .card { background: white; padding: 20px; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); text-align: center; width: 300px; }
        img { border-radius: 50%; width: 100px; height: 100px; background: #ddd; }
        button { margin-top: 20px; padding: 10px; cursor: pointer; width: 100%; }
        .error-text { color: red; font-weight: bold; }
    </style>
</head>
<body>

    <div class="card">
        <img id="user-photo" src="" alt="Foto">
        <h3 id="user-name">Apasă butonul...</h3>
        <p id="user-email">-</p>
        <button id="btn-fetch">Generează Utilizator Nou</button>
    </div>

    <script>
        const btn = document.getElementById('btn-fetch');
        const photo = document.getElementById('user-photo');
        const nameDisplay = document.getElementById('user-name');
        const emailDisplay = document.getElementById('user-email');

        // 1. Folosim Async/Await pentru o sintaxă curată
        async function getRandomUser() {
            console.log('Cerere trimisă...'); // Log cerere trimisă
            
            // 2. Bloc Try/Catch pentru gestionarea erorilor
            try {
                const response = await fetch('https://randomuser.me/api/');

                // Verificăm dacă răspunsul HTTP este de succes (status 200-299)
                if (!response.ok) {
                    throw new Error(`Eroare HTTP! Status: ${response.status}`);
                }

                const data = await response.json();
                
                // 3. Log date primite cu succes
                console.log('Date primite cu succes', data);

                const user = data.results[0];
                updateUI(user);

            } catch (error) {
                // 3. Log eroare
                console.error('Eroare la preluarea datelor:', error);
                
                // 4. Alertă în browser pentru utilizator
                alert("A apărut o eroare la conectarea cu serverul. Te rugăm să încerci din nou.");
                
                nameDisplay.innerText = "Eroare la încărcare";
                nameDisplay.className = "error-text";
            }
        }

        function updateUI(user) {
            nameDisplay.className = ""; // Resetăm clasa de eroare dacă există
            photo.src = user.picture.large;
            nameDisplay.innerText = `${user.name.first} ${user.name.last}`;
            emailDisplay.innerText = user.email;
        }

        btn.addEventListener('click', getRandomUser);
    </script>
</body>
</html>